{"version":3,"sources":["components/Parse/parse.module.css","components/Table/Table.module.css","components/Spinner/Spinner.module.css","components/Table/Table.js","components/Spinner/Spinner.js","components/Parse/parse.js","App.jsx","index.js"],"names":["module","exports","Table","data","headers","tableBody","useRef","useEffect","current","objOfTableColumns","map","header","includes","split","join","reduce","accObj","normalizedHeader","collection","querySelectorAll","key","validate","clientObj","forEach","item","textContent","length","slice","classList","add","s","error","test","Number","isInteger","idx","isNaN","date","dateArr","isExpirationValid","dateNotValid","year","month","day","Date","now","className","wrapBlock","tableClients","index","ref","client","clientKeys","Object","keys","ID","Spinner","classNames","iconSpin","IDLE","PENDING","ERROR","SUCCESS","ReaderCSV","useState","dataCSV","setDataCSV","headersCSV","setHeadersCSV","status","setStatus","buttonRef","handleOpenDialog","event","open","onFileLoad","arrOfObjCSV","trimmedArrOfArrCSV","el","trim","push","strCSV","parsedClientsCSV","dsvFormat","parse","clientsWithDublicateProp","phoneNumber","toLowerCase","yearlyIncome","toFixed","toUpperCase","license","Phone","Email","onError","err","file","inputElem","reason","console","log","type","onClick","btnLoad","errorBlock","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.5d3f83ed.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"btnLoad\":\"parse_btnLoad__zwAtY\",\"errorBlock\":\"parse_errorBlock__19EUx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapBlock\":\"Table_wrapBlock__3m5Bg\",\"tableClients\":\"Table_tableClients__250uo\",\"error\":\"Table_error__4Mi-2\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"iconSpin\":\"Spinner_iconSpin__DshYl\",\"icon-spin\":\"Spinner_icon-spin__3WqPZ\"};","import { useEffect, useRef } from 'react';\nimport s from './Table.module.css';\n\nexport default function Table({ data, headers }) {\n    const tableBody = useRef(null);\n    useEffect(() => {\n        if (!tableBody.current) {\n            return;\n        }\n\n        const normalizedHeaders = headers.map(header => header.includes(' ')\n            ? header.split(' ').join('.')\n            : header);\n\n        const objOfTableColumns = normalizedHeaders.reduce((accObj, normalizedHeader) => {\n            if (normalizedHeader === \"ID\" || normalizedHeader === \"Full.Name\" || normalizedHeader === \"License.states\" || normalizedHeader === \"Duplicate.with\") {\n                return accObj;\n            }\n            const collection = tableBody.current.querySelectorAll(`.${normalizedHeader}`);\n            return { ...accObj, [normalizedHeader]: collection };\n        }, {})\n\n        for (const key in objOfTableColumns) {\n            validate(key, objOfTableColumns)\n        }\n\n        function validate(key, clientObj) {\n            const collection = clientObj[key];\n            switch (key) {\n                case \"Phone\":\n                    collection.forEach(item => {\n                        if (item.textContent.length !== 12 || item.textContent.slice(0, 2) !== \"+1\") {\n                            item.classList.add(s.error);\n                        }\n                    })\n                    break;\n\n                case \"Email\":\n                    collection.forEach(item => {\n                        if (!/^([a-z0-9_.-])+@[a-z0-9-]+\\.([a-z]{2,4}\\.)?[a-z]{2,4}$/.test(item.textContent)) {\n                            item.classList.add(s.error);\n                        }\n                    })\n                    break;\n\n                case \"Age\":\n                    collection.forEach(item => {\n                        if (!Number.isInteger(Number(item.textContent)) || item.textContent < 21) {\n                            item.classList.add(s.error);\n                        }\n                    })\n                    break;\n\n                case \"Experience\":\n                    collection.forEach((item, idx) => {\n                        if (item.textContent < 0 || +item.textContent > +clientObj[\"Age\"][idx].textContent) {\n                            item.classList.add(s.error);\n                        }\n                    })\n                    break;\n\n                case \"Yearly.Income\":\n                    collection.forEach(item => {\n                        if (isNaN(item.textContent) || item.textContent < 0 || item.textContent > 1000000) {\n                            item.classList.add(s.error);\n                        }\n                    })\n                    break;\n\n                case \"Has.children\":\n                    collection.forEach(item => {\n                        if (!(item.textContent===\"TRUE\" || item.textContent===\"FALSE\" || item.textContent===\"\")) {\n                            item.classList.add(s.error);\n                        }\n                    })\n                    break;\n\n                case \"License.number\":\n                    collection.forEach(item => {\n                        if (!(item.textContent.length===6 && /^[A-Za-z0-9]+$/.test(item.textContent))) {\n                            item.classList.add(s.error);\n                        }\n                    })\n                    break;\n\n                case \"Expiration.date\":\n                    collection.forEach(item => {\n                        if (dateNotValid(item.textContent)) {\n                            item.classList.add(s.error);\n                        }\n                    })\n                    break;\n\n                default:\n                    break;\n            }\n        }\n\n        function dateNotValid(date) {\n        if (date.includes('-')) {\n            const dateArr = date.split('-');\n            if (dateArr[0].length === 4) {\n                const year = dateArr[0];\n                const month = dateArr[1];\n                const day = dateArr[2];\n                return isExpirationValid(year, month, day);\n            }\n        }\n        if (date.includes('/')) {\n            const dateArr = date.split('/');\n            if (dateArr[2].length === 4) {\n                const year = dateArr[2];\n                const month = dateArr[0];\n                const day = dateArr[1];\n                return isExpirationValid(year, month, day);\n            }\n        }\n        return true;\n        }\n\n        function isExpirationValid(year, month, day) {\n        //дотошну перевірку \"скільки днів у певному місяці і чи є 29днів у лютому в залежності від високосного року\" не роблю на етапі тестування\n        if (month > 12 || month < 1 || day > 31 || day < 1) {\n            return true;\n        }\n        const expirationDate = new Date(year, month - 1, day);\n        const currentDate = Date.now();\n        return expirationDate - currentDate > 0 ? false : true;\n        }\n\n    }, [headers])\n\n    return (\n        <div className={s.wrapBlock} >\n            <table className={s.tableClients}>\n                <thead>\n                    <tr>\n                        <th>ID</th>\n                        {headers.map((header, index) => (<th key={index}>{header}</th>))}\n                    </tr>\n                </thead>\n\n                <tbody ref={tableBody}>\n                    {data.map((client) => {\n                        const clientKeys = Object.keys(client);\n                        return (<tr key={client.ID}>\n                            {clientKeys.map((key, idx) => <td key={idx} className={key}>{client[key]}</td>)}\n                        </tr>)\n                    })}\n                </tbody>\n            </table>\n        </div>\n    )\n}","import { CgSpinnerTwoAlt } from 'react-icons/cg';\nimport s from './Spinner.module.css'\n\nexport default function Spinner({classNames=\"\"}) {\n    return <CgSpinnerTwoAlt className={`${s.iconSpin} ${classNames}`}/>;\n}","import {useRef, useState} from 'react';\nimport { CSVReader } from 'react-papaparse';\nimport { dsvFormat } from 'd3-dsv';\nimport Table from '../Table';\nimport Spinner from '../Spinner';\nimport s from './parse.module.css'\n\nconst { IDLE, PENDING, ERROR, SUCCESS } = {\n    IDLE: 'idle',\n    PENDING: 'pending',\n    ERROR: 'error',\n    SUCCESS: 'success'\n}\n\nexport default function ReaderCSV() {\n    const [dataCSV, setDataCSV] = useState();\n    const [headersCSV, setHeadersCSV] = useState();\n    const [status, setStatus] = useState(IDLE);\n    const buttonRef = useRef();\n\n    const phoneNormalize = (phoneNumber) => {\n        if (phoneNumber.length === 10) {\n            return \"+1\"+phoneNumber;\n        }\n        if (phoneNumber.length === 11 && phoneNumber.slice(0, 1) === \"1\") {\n            return \"+\"+phoneNumber;\n        }\n        return phoneNumber;\n    }\n\n    const yearlyIncomeNormalize = (yearlyIncome) => {\n        return Number(yearlyIncome)\n            ? Number(yearlyIncome).toFixed(2)\n            : yearlyIncome;\n    }\n\n    const licenseNormalize = (license) => {\n        if (license.includes('|')) {\n            const licenseArr = license.split('|');\n            const shortCutLicenseArr = licenseArr.map(license => license.trim().slice(0, 2).toUpperCase());\n            return shortCutLicenseArr.join(\", \");\n        }\n        return license.slice(0, 2).toUpperCase();\n    }\n\n    const handleOpenDialog = (event) => {\n        buttonRef.current && buttonRef.current.open(event);\n    }\n\n    const handleOnFileLoad = (arrOfObjCSV) => {\n        setStatus(PENDING);\n\n        const trimmedArrOfArrCSV = arrOfObjCSV.map(({ data }) =>\n            data.map(el => el.trim())\n        )\n\n        trimmedArrOfArrCSV[0].push(\"Duplicate with\");\n        setHeadersCSV(trimmedArrOfArrCSV[0]);\n        const arrOfStrings = trimmedArrOfArrCSV.map(el => el.join(';'));\n        const strCSV = arrOfStrings.join('\\n');\n        const parsedClientsCSV = dsvFormat(\";\").parse(strCSV);\n        const error = parsedClientsCSV.reduce((error, client) => {\n            if (!client[\"Full Name\"] || !client[\"Phone\"] || !client[\"Email\"]) {\n                error = true;\n            }\n            return error;\n        }, false)\n        if (error) {\n            setStatus(ERROR);\n            return;\n        }\n        const normalizedClients = parsedClientsCSV.map(client => {\n\n            return {\n                ...client,\n                \"Phone\": phoneNormalize(client[\"Phone\"]),\n                \"Email\": client[\"Email\"].toLowerCase(),\n                \"Yearly Income\": yearlyIncomeNormalize(client[\"Yearly Income\"]),\n                \"Has children\": client[\"Has children\"].toUpperCase(),\n                \"License states\": licenseNormalize(client[\"License states\"])\n            };\n        })\n        const clientsWithDublicateProp = normalizedClients.map((client, idx) => ({ \"ID\": idx + 1, ...client, \"Duplicate with\": [] }));\n        clientsWithDublicateProp.forEach(({ID, Phone, Email}) => {\n            clientsWithDublicateProp.forEach(client => {\n                if (client.ID !== ID && (client.Phone === Phone || client.Email === Email)) {\n                    client[\"Duplicate with\"] = ID;\n                }\n            })\n        })\n        setDataCSV(clientsWithDublicateProp);\n        setStatus(SUCCESS);\n  }\n\n  const handleOnError = (err, file, inputElem, reason) => {\n      console.log(err, file, inputElem, reason);\n  }\n\n    return (\n      <>\n        <CSVReader\n          ref={buttonRef}\n          onFileLoad={handleOnFileLoad}\n          onError={handleOnError}\n        >\n          {() => (\n            <>\n              <button type='button' onClick={handleOpenDialog} className={s.btnLoad} >\n                Import users\n              </button>\n            </>\n          )}\n        </CSVReader>\n        {status===SUCCESS && <Table data={dataCSV} headers={headersCSV} />}\n        {status===ERROR && (\n            <div className={s.errorBlock}>\n                <h1>File format is not correct</h1>\n            </div>)\n            }\n        {status===PENDING && <Spinner/>}\n      </>\n    )\n}","import './App.css';\nimport CSVReader from './components/Parse';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <CSVReader/>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App.jsx';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n"],"sourceRoot":""}