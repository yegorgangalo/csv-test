{"version":3,"sources":["components/Parse/parse.module.css","components/Spinner/Spinner.module.css","components/Table/Table.js","components/Spinner/Spinner.js","components/Parse/parse.js","App.jsx","index.js","components/Table/Table.module.css"],"names":["module","exports","Table","data","headers","validate","key","clientObj","length","slice","test","Number","isInteger","date","includes","dateArr","split","isExpirationValid","dateNotValid","year","month","day","Date","now","className","s","wrapBlock","tableClients","map","header","index","client","clientKeys","Object","keys","idx","error","ID","Spinner","classNames","iconSpin","IDLE","PENDING","ERROR","SUCCESS","ReaderCSV","useState","dataCSV","setDataCSV","headersCSV","setHeadersCSV","status","setStatus","buttonRef","useRef","handleOpenDialog","event","current","open","ref","onFileLoad","arrOfObjCSV","trimmedArrOfArrCSV","el","trim","push","strCSV","join","parsedClientsCSV","dsvFormat","parse","reduce","clientsWithDublicateProp","phoneNumber","toLowerCase","toFixed","toUpperCase","license","forEach","Phone","Email","onError","err","file","inputElem","reason","console","log","type","onClick","btnLoad","errorBlock","App","ReactDOM","render","StrictMode","document","getElementById"],"mappings":"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","file":"static/js/main.eb7a8800.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"btnLoad\":\"parse_btnLoad__zwAtY\",\"errorBlock\":\"parse_errorBlock__19EUx\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"iconSpin\":\"Spinner_iconSpin__DshYl\",\"icon-spin\":\"Spinner_icon-spin__3WqPZ\"};","// import { useEffect, useState } from 'react';\nimport s from './Table.module.css';\n\nexport default function Table({data, headers}) {\n\n    function validate(key, clientObj) {\n        if (key === \"Phone\" && (clientObj[key].length !==12 || clientObj[key].slice(0,2)!==\"+1\" )) {\n            return false;\n        }\n        if (key === \"Email\" && !(/^([a-z0-9_.-])+@[a-z0-9-]+\\.([a-z]{2,4}\\.)?[a-z]{2,4}$/.test(clientObj[key]) )) {\n            return false;\n        }\n        if (key === \"Age\" && (!Number.isInteger(Number(clientObj[key])) || clientObj[key] < 21)) {\n            return false;\n        }\n        if (key === \"Experience\" && (clientObj[key] < 0 || clientObj[key] > clientObj[\"Age\"])) {\n            return false;\n        }\n        if (key === \"Yearly Income\" && (clientObj[key] > 1000000)) {\n            return false;\n        }\n        if (key === \"Has children\" && !(clientObj[key]===\"TRUE\" || clientObj[key]===\"FALSE\" || clientObj[key]===\"\")) {\n            return false;\n        }\n        if (key === \"License number\" && !(clientObj[key].length===6 && /^[A-Za-z0-9]+$/.test(clientObj[key]))) {\n            return false;\n        }\n        if (key === \"Expiration date\" && dateNotValid(clientObj[key])) {\n            return false;\n        }\n        return true;\n    }\n\n    function dateNotValid(date) {\n        if (date.includes('-')) {\n            const dateArr = date.split('-');\n            if (dateArr[0].length === 4) {\n                const year = dateArr[0];\n                const month = dateArr[1];\n                const day = dateArr[2];\n                return isExpirationValid(year, month, day);\n            }\n        }\n        if (date.includes('/')) {\n            const dateArr = date.split('/');\n            if (dateArr[2].length === 4) {\n                const year = dateArr[2];\n                const month = dateArr[0];\n                const day = dateArr[1];\n                return isExpirationValid(year, month, day);\n            }\n        }\n        return true;\n    }\n\n    function isExpirationValid(year, month, day) {\n        //дотошну перевірку \"скільки днів у певному місяці і чи є 29днів у лютому в залежності від високосного року\" не роблю на етапі тестування\n        if (month > 12 || month < 1 || day > 31 || day < 1) {\n            return true;\n        }\n        const expirationDate = new Date(year, month - 1, day);\n        const currentDate = Date.now();\n        return expirationDate - currentDate > 0 ? false : true;\n    }\n\n    return (\n        <div className={s.wrapBlock} >\n            <table className={s.tableClients}>\n                <thead>\n                    <tr>\n                        <th>ID</th>\n                        {headers.map((header, index) => (<th key={index}>{header}</th>))}\n                    </tr>\n                </thead>\n\n                <tbody>\n                    {data.map((client) => {\n                        const clientKeys = Object.keys(client);\n                        return (<tr key={client.ID}>\n                            {clientKeys.map((key, idx) => {\n                                return validate(key, client)\n                                    ? (<td key={idx}>{client[key]}</td>)\n                                    : (<td key={idx} className={s.error} >{client[key]}</td>)\n                            })}\n                        </tr>)\n                    })}\n                </tbody>\n            </table>\n        </div>\n    )\n}","import { CgSpinnerTwoAlt } from 'react-icons/cg';\nimport s from './Spinner.module.css'\n\nexport default function Spinner({classNames=\"\"}) {\n    return <CgSpinnerTwoAlt className={`${s.iconSpin} ${classNames}`}/>;\n}","import {useRef, useState} from 'react';\nimport { CSVReader } from 'react-papaparse';\nimport { dsvFormat } from 'd3-dsv';\nimport Table from '../Table';\nimport Spinner from '../Spinner';\nimport s from './parse.module.css'\n\nconst { IDLE, PENDING, ERROR, SUCCESS } = {\n    IDLE: 'idle',\n    PENDING: 'pending',\n    ERROR: 'error',\n    SUCCESS: 'success'\n}\n\nexport default function ReaderCSV() {\n    const [dataCSV, setDataCSV] = useState();\n    const [headersCSV, setHeadersCSV] = useState();\n    const [status, setStatus] = useState(IDLE);\n    const buttonRef = useRef();\n\n    const phoneNormalize = (phoneNumber) => {\n        if (phoneNumber.length === 10) {\n            return \"+1\"+phoneNumber;\n        }\n        if (phoneNumber.length === 11 && phoneNumber.slice(0, 1) === \"1\") {\n            return \"+\"+phoneNumber;\n        }\n        return phoneNumber;\n    }\n\n    const licenseNormalize = (license) => {\n        if (license.includes('|')) {\n            const licenseArr = license.split('|');\n            const shortCutLicenseArr = licenseArr.map(license => license.trim().slice(0, 2).toUpperCase());\n            return shortCutLicenseArr.join(\", \");\n        }\n        return license.slice(0, 2).toUpperCase();\n    }\n\n    const handleOpenDialog = (event) => {\n        buttonRef.current && buttonRef.current.open(event);\n    }\n\n    const handleOnFileLoad = (arrOfObjCSV) => {\n        setStatus(PENDING);\n\n        const trimmedArrOfArrCSV = arrOfObjCSV.map(({ data }) =>\n            data.map(el => el.trim())\n        )\n\n        trimmedArrOfArrCSV[0].push(\"Duplicate with\");\n        setHeadersCSV(trimmedArrOfArrCSV[0]);\n        const arrOfStrings = trimmedArrOfArrCSV.map(el => el.join(';'));\n        const strCSV = arrOfStrings.join('\\n');\n        const parsedClientsCSV = dsvFormat(\";\").parse(strCSV);\n        const error = parsedClientsCSV.reduce((error, client) => {\n            if (!client[\"Full Name\"] || !client[\"Phone\"] || !client[\"Email\"]) {\n                error = true;\n            }\n            return error;\n        }, false)\n        if (error) {\n            setStatus(ERROR);\n            return;\n        }\n        const normalizedClients = parsedClientsCSV.map(client => {\n\n            return {\n                ...client,\n                \"Phone\": phoneNormalize(client[\"Phone\"]),\n                \"Email\": client[\"Email\"].toLowerCase(),\n                \"Yearly Income\": Number(client[\"Yearly Income\"]).toFixed(2),\n                \"Has children\": client[\"Has children\"].toUpperCase(),\n                \"License states\": licenseNormalize(client[\"License states\"])\n            };\n        })\n        const clientsWithDublicateProp = normalizedClients.map((client, idx) => ({ \"ID\": idx + 1, ...client, \"Duplicate with\": [] }));\n        clientsWithDublicateProp.forEach(({ID, Phone, Email}) => {\n            clientsWithDublicateProp.forEach(client => {\n                if (client.ID !== ID && (client.Phone === Phone || client.Email === Email)) {\n                    client[\"Duplicate with\"] = ID;\n                }\n            })\n        })\n        setDataCSV(clientsWithDublicateProp);\n        setStatus(SUCCESS);\n  }\n\n  const handleOnError = (err, file, inputElem, reason) => {\n      console.log(err, file, inputElem, reason);\n  }\n\n    return (\n      <>\n        <CSVReader\n          ref={buttonRef}\n          onFileLoad={handleOnFileLoad}\n          onError={handleOnError}\n        >\n          {() => (\n            <>\n              <button type='button' onClick={handleOpenDialog} className={s.btnLoad} >\n                Import users\n              </button>\n            </>\n          )}\n        </CSVReader>\n        {status===SUCCESS && <Table data={dataCSV} headers={headersCSV} />}\n        {status===ERROR && (\n            <div className={s.errorBlock}>\n                <h1>File format is not correct</h1>\n            </div>)\n            }\n        {status===PENDING && <Spinner/>}\n      </>\n    )\n}","import './App.css';\nimport CSVReader from './components/Parse';\n\nfunction App() {\n  return (\n    <div className=\"App\">\n      <CSVReader/>\n    </div>\n  );\n}\n\nexport default App;\n","import React from 'react';\nimport ReactDOM from 'react-dom';\nimport './index.css';\nimport App from './App.jsx';\n\nReactDOM.render(\n  <React.StrictMode>\n    <App />\n  </React.StrictMode>,\n  document.getElementById('root')\n);\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"wrapBlock\":\"Table_wrapBlock__3m5Bg\",\"tableClients\":\"Table_tableClients__250uo\",\"error\":\"Table_error__4Mi-2\"};"],"sourceRoot":""}